// OBST 
#include<iostream> 
using namespace std; 
 
#define N 5 
 
class obst{ 
    private: 
        int p[N],q[N]; 
        int w[N][N],c[N][N],r[N][N]; 
        string keys[N]; 
        int n; 
         
    public: 
        obst(){ 
            cout<<"Enter Number of elements = "; 
            cin>>n; 
             
            for(int i=0;i<n;i++){ 
                cout<<"Enter p["<<i+1<<"] >>"; 
                cin>>p[i]; 
                cout<<"Enter key["<<i+1<<"] >>"; 
                cin>>keys[i]; 
 
            } 
            for(int i=0;i<=n;i++){ 
                cout<<"Enter q["<<i<<"] >>"; 
                cin>>q[i]; 
            } 
        } 
         
        void construct(){ 
            int x; 
            for(int i=0;i<=n;i++){ 
                w[i][i]=q[i]; 
                c[i][i]=0; 
                r[i][i]=0; 
            } 
             
            for(int diff=1;diff<=n;diff++){ 
                int j=0; 
                 
                for(int i=0;i<n;i++){ 
                    j=i+diff; 
                     
                    if(j<=n){ 
                        w[i][j]=w[i][j-1]+p[j]+q[j]; 
                        int min =9999; 
                         
                        for(int k=i+1;k<=j;k++){ 
                            c[i][j]=c[i][k-1]+c[k][j]+w[i][j]; 
                            if(c[i][j]<min) 
                            min=c[i][j],x=k; 
                        } 
                         
                        c[i][j]=min; 
                        r[i][j]=x; 
                    } 
                } 
 
            } 
         
         
        cout<<"COST : "<<c[0][n] 
<<"\nRoot : "<<keys[r[0][n]] 
<<endl; 
} 
 
 
void display(){ 
    for (int i=0; i<=n; i++){ 
        cout<<w[i][i]<<" "<<c[i][i]<<" " << r[i][i]<< "\t"; 
    } 
    cout<<"\n\n"; 
    for(int diff=1;diff<=n;diff++){ 
        int j=0; 
        for(int i=0;i<n;i++){ 
            j=i+diff; 
             
            if(j<=n) 
                cout<<w[i][j]<<" "<<c[i][j]<<" " << r[i][j]<< "\t"; 
        } 
        cout<< "\n\n"; 
    } 
} 
 
         
}; 
 
 
int main() 
{ 
    cout<<"OBST"; 
    obst o; 
    o.construct(); 
    o.display(); 
} 
 
